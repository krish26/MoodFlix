<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MoodFlix â€“ Where Emotion Meets Cinema</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">

    <style>
        * { font-family: 'Poppins', sans-serif; }

        body {
            background: linear-gradient(-45deg, #0f2027, #203a43, #2c5364, #141e30);
            background-size: 400% 400%;
            animation: gradientMove 15s ease infinite;
            min-height: 100vh;
            padding: 20px 0;
            color: white;
        }

        @keyframes gradientMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .main-container {
            backdrop-filter: blur(25px);
            background: rgba(255,255,255,0.05);
            border-radius: 25px;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 30px 80px rgba(0,0,0,0.6);
            padding: 50px;
            max-width: 1400px;
            margin: auto;
        }

        .logo {
            font-size: 3.5rem;
            font-weight: 800;
            background: linear-gradient(90deg, #ff416c, #ff4b2b, #ffcc00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
        }

        .tagline {
            color: #ccc;
            font-size: 1.1rem;
            margin-bottom: 40px;
        }

        .mood-card {
            border-radius: 18px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            background: rgba(255,255,255,0.07);
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s ease;
            height: 100%;
        }

        .mood-card:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 0 25px rgba(255,75,43,0.7);
            border-color: #ff4b2b;
        }

        .mood-card.active {
            background: linear-gradient(135deg, #ff416c, #ff4b2b);
            box-shadow: 0 0 35px rgba(255,75,43,0.9);
        }

        .mood-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
            transition: 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ff416c, #ff4b2b);
            border: none;
            padding: 14px;
            border-radius: 12px;
            font-weight: 600;
        }

        .btn-primary:hover {
            transform: scale(1.05);
        }

        .btn-outline-light {
            border-radius: 12px;
            padding: 14px;
        }

        .movie-card {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
            transition: 0.4s ease;
            margin-bottom: 30px;
            animation: fadeUp 0.5s ease forwards;
        }

        .movie-card:hover {
            transform: scale(1.02);
            box-shadow: 0 25px 60px rgba(0,0,0,0.7);
        }

        .movie-poster img {
            width: 100%;
            height: 350px;
            object-fit: cover;
        }

        .movie-body {
            padding: 20px;
        }

        .genre-badge {
            background: rgba(255,75,43,0.2);
            padding: 5px 10px;
            border-radius: 20px;
            margin: 3px;
            display: inline-block;
            font-size: 0.8rem;
        }

        .loading-spinner {
            text-align: center;
            padding: 60px 0;
        }

        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            .logo { font-size: 2.2rem; }
        }
    </style>
</head>

<body>
<div class="container">
    <div class="main-container">

        <div class="text-center mb-5">
            <h1 class="logo">ðŸŽ¬ MoodFlix</h1>
            <p class="tagline">Where Emotion Meets Cinema.</p>
        </div>

        <div class="row">

            <!-- Mood Selection -->
            <div class="col-lg-4 mb-4">
                <h4 class="mb-4"><i class="bi bi-emoji-smile"></i> Choose Your Mood</h4>
                <div class="row g-3" id="moodGrid"></div>

                <div class="d-grid gap-3 mt-4">
                    <button class="btn btn-primary" id="getRecommendationsBtn" disabled>
                        <i class="bi bi-play-fill"></i> Find My Movie
                    </button>
                    <button class="btn btn-outline-light" id="surpriseMeBtn">
                        <i class="bi bi-shuffle"></i> Surprise Me
                    </button>
                </div>
            </div>

            <!-- Results -->
            <div class="col-lg-8">
                <div id="emptyState" class="text-center p-5">
                    <i class="bi bi-film" style="font-size: 4rem; opacity:0.3;"></i>
                    <p class="mt-3 text-muted">Select your mood and discover cinematic magic âœ¨</p>
                </div>

                <div id="loadingState" class="loading-spinner" style="display:none;">
                    <div class="spinner-border text-light"></div>
                    <p class="mt-3 text-muted">Curating your experience...</p>
                </div>

                <div id="resultsArea" style="display:none;">
                    <h3 id="resultsTitle" class="mb-4"></h3>
                    <div id="moviesGrid"></div>
                </div>
            </div>

        </div>
    </div>
</div>

<script>
const TMDB_IMAGE_BASE = 'https://image.tmdb.org/t/p/w500';
let selectedMood = null;

const moodData = {
    happy: { icon: 'bi-emoji-smile', name: 'Happy' },
    sad: { icon: 'bi-emoji-frown', name: 'Sad' },
    excited: { icon: 'bi-lightning-charge', name: 'Excited' },
    scared: { icon: 'bi-exclamation-triangle', name: 'Scared' },
    romantic: { icon: 'bi-heart-fill', name: 'Romantic' },
    thoughtful: { icon: 'bi-lightbulb', name: 'Thoughtful' },
    adventurous: { icon: 'bi-compass', name: 'Adventurous' },
    relaxed: { icon: 'bi-cup-hot', name: 'Relaxed' },
    mysterious: { icon: 'bi-incognito', name: 'Mysterious' },
    inspired: { icon: 'bi-stars', name: 'Inspired' }
};



function renderMoods() {
    const moodGrid = document.getElementById('moodGrid');
    Object.keys(moodData).forEach(mood => {
        const col = document.createElement('div');
        col.className = 'col-6';
        col.innerHTML = `
            <div class="mood-card" data-mood="${mood}">
                <div class="mood-icon">
                    <i class="bi ${moodData[mood].icon}"></i>
                </div>

                <div>${moodData[mood].name}</div>
            </div>`;
        moodGrid.appendChild(col);

        col.querySelector('.mood-card').onclick = function() {
            document.querySelectorAll('.mood-card').forEach(c => c.classList.remove('active'));
            this.classList.add('active');
            selectedMood = mood;
            document.getElementById('getRecommendationsBtn').disabled = false;
        };
    });
}

async function getRecommendations() {
    if (!selectedMood) return;
    showLoading();

    const response = await fetch('/recommendations/', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ mood: selectedMood, count: 5 })
    });

    const data = await response.json();
    if (data.success) {
        displayResults(data.recommendations, selectedMood.toUpperCase() + " Picks");
    }
}

function displayResults(movies, title) {
    document.getElementById('emptyState').style.display = 'none';
    document.getElementById('loadingState').style.display = 'none';
    document.getElementById('resultsArea').style.display = 'block';
    document.getElementById('resultsTitle').textContent = title;

    const grid = document.getElementById('moviesGrid');
    grid.innerHTML = '';

    movies.forEach(movie => {
        const card = document.createElement('div');
        card.className = 'movie-card';

        const poster = movie.poster_path 
            ? `<img src="${TMDB_IMAGE_BASE + movie.poster_path}">`
            : `<div style="height:350px;background:#222;"></div>`;

        card.innerHTML = `
            <div class="movie-poster">${poster}</div>
            <div class="movie-body">
                <h5>${movie.title}</h5>
                <div>${movie.genres.map(g => `<span class="genre-badge">${g}</span>`).join('')}</div>
                <p class="mt-2 text-muted">${movie.overview}</p>
            </div>
        `;
        grid.appendChild(card);
    });
}

function showLoading() {
    document.getElementById('emptyState').style.display = 'none';
    document.getElementById('resultsArea').style.display = 'none';
    document.getElementById('loadingState').style.display = 'block';
}

document.getElementById('getRecommendationsBtn').addEventListener('click', getRecommendations);
document.getElementById('surpriseMeBtn').addEventListener('click', getRecommendations);

renderMoods();
</script>

</body>
</html>
